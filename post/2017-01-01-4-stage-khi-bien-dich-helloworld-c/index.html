<!DOCTYPE html>
<html lang="en-us">
    <head>
        

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>4 Stage khi biên dịch HelloWorld.c</title>
        
        <style>

    html body {
        font-family: 'Raleway', sans-serif;
        background-color: white;
    }

    :root {
        --accent: red;
        --border-width:  5px ;
    }

</style>


<link rel="stylesheet" href="css/main.css">





<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">


 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"> 


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
 

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/c.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/go.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/bash.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/html.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/javascript.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/ruby.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/shell.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/perl.min.js"></script>
    
    <script>hljs.initHighlightingOnLoad();</script>






<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>
 <meta name="generator" content="Hugo 0.58.3" />
        

        

        
            <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        

        

    </head>

    <body>
        

        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand visible-xs" href="#">4 Stage khi biên dịch HelloWorld.c</a>
                    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <div class="collapse navbar-collapse">
                    
                        <ul class="nav navbar-nav">
                            
                                <li><a href="/">Home</a></li>
                            
                                <li><a href="/post/">Posts</a></li>
                            
                                <li><a href="/tags/">Tags</a></li>
                            
                                <li><a href="/categories/">Category</a></li>
                            
                                <li><a href="/about/">About</a></li>
                            
                        </ul>
                    
                    
                        <ul class="nav navbar-nav navbar-right">
                            
                                <li class="navbar-icon"><a href="mailto:pvta2pn@gmail.com"><i class="fa fa-envelope-o"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://github.com/minatu2d/"><i class="fa fa-github"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://facebook.com/pvta2cvp/"><i class="fa fa-facebook"></i></a></li>
                            
                        </ul>
                    
                </div>
            </div>
        </nav>


<main>

    <div>
        <h2>4 Stage khi biên dịch HelloWorld.c</h2>
        <h5>January 1, 2017</h5>
        
<a href="tags/gcc"><kbd class="item-tag">GCC</kbd></a>

<a href="tags/helloworld"><kbd class="item-tag">HelloWorld</kbd></a>


    </div>

    <div align="start" class="content"></p>
<h2>1. 4 Stage khi compiling</h2>
<p>Để chuyển từ 1 file source code <strong>HelloWorld.c</strong> ở trên sang dạng chạy được <strong>HelloWorld</strong> bằng GCC sẽ có 4 stages sau.<br />
Kết quả của Stage trước là sẽ là đầu vào của Stage sau.</p>
<p><img class="alignnone size-full wp-image-1745" src="{{ site.baseurl }}/assets/compiling_4_stage.png" alt="compiling_4_stage" width="756" height="490" /></p>
<p>Khi chúng ta gõ</p>
<p>[code lang=shell]<br />
$gcc -o HelloWorld HelloWorld.c<br />
[/code]</p>
<p>Thì chỉ kết quả của Stage sẽ được giữ lại, kết quả của các Stage trung gian không được lưu lại.</p>
<h2>2. Chi tiết mỗi Stage</h2>
<h3>2.1 Stage 1 : Preprocessing (Tiền xử lý)</h3>
<p>Ở Stage này, các tiền xử lý (bắt đầu băng dấu #) được xử lý. Ví dụ các chỉ thị dịch #ifdef, #if, #include sẽ được thay thế hết.<br />
Do vậy, các lỗi về sai đường dẫn file header sẽ được phát hiện. Kết quả các đoạn chị thị dịch #ifdef, #elif cũng sẽ được đưa ra.</p>
<p>Để hiển thị kết quả đầu ra của Stage này, ta có thể sử dụng command sau:</p>
<p>Khi sử dụng <strong>gcc</strong>:</p>
<p>[code lang=shell]<br />
$gcc -E HelloWorld.c &gt; HelloWorld.i<br />
[/code]</p>
<p>Hoặc sử dụng <strong>cpp</strong> (C Preprocessor)</p>
<p>[code lang=shell]<br />
$cpp HelloWorld.c &gt; HelloWorld.i<br />
[/code]</p>
<h3>2.2 Stage 2 : Biên dịch sang mã Assembly</h3>
<p>Ở Stage này, kết quả từ Stage 1 sẽ được biên dịch thành source code trong ngôn ngữ Assembly.<br />
Để hiển thị đầu ra của Stage này, ta sử dụng command sau:</p>
<p>[code lang=shell]<br />
$gcc -S HelloWorld.c<br />
[/code]</p>
<p>Ta sẽ được file <strong>HelloWorld.s</strong> trong thư mục hiện tại.</p>
<h3>2.3 Stage 3 : Biên dịch sang mã máy</h3>
<p>Ở Stage này, GCC sẽ biên dịch kết của từ Stage 2 (Assembly Code) sang dạng mã máy.<br />
Tức là GCC sẽ phải biết môi trường mà nó sẽ compile cho là gì. (Môi trường chạy hay Host)</p>
<p>Để lấy kết quả đầu ra của Stage này, ta sử dụng command sau:</p>
<p>[code lang=shell]<br />
$gcc -c HelloWorld.c<br />
[/code]</p>
<p>Ta sẽ được file <strong>HelloWorld.o</strong> nằm ở thư mục hiện tại.</p>
<h3>2.4 Stage 4 : Link để tạo file chạy được</h3>
<p>Ta đã có kết quả từ Stage là các file <strong>.o</strong>.<br />
Từ mỗi file <strong>.c</strong> sẽ tạo ra 1 file <strong>.o</strong>.</p>
<p>Đó chỉ là các file rời rạc, hay các file object hay module.</p>
<p>Để có 1 chương trình chạy được, ta cần liên kết hay là <strong>Link</strong> các file object lại.</p>
<p>Quá trình link về cơ bản, sẽ lấy nội dung (là hàm hoặc biến) rồi xếp lại theo một thứ tự để máy tính có thể hiểu và chạy được.</p>
<p>Có 2 loại link : Link tĩnh (các file <strong>.o</strong> và <strong>.a</strong>), và Link động (các file <strong>.so</strong>).</p>
<p>Đàu ra Link tĩnh là một file chứa toàn bộ mã máy kể cả các hàm thư viện chuẩn, chỉ cần load lên bộ nhớ là có thể chạy được. Vì thế kích thước thường rất lớn.</p>
<p>Ta có thể sử dụng command sau:</p>
<p>[code lang=shell]<br />
$gcc -static -o HelloWorld HelloWorld.c<br />
[/code]</p>
<p>Đầu ra của Link động là một file không chứa toàn bộ mã của các thư viện phụ thuộc. Nó có thể yêu cầu kernel load khi thực sự được chạy hoặc được gọi. Vì thế, kích thước file thường nhỏ.</p>
<p>GCC sẽ mặc định sử dụng Link động nên ta có thể sử dụng command sau:</p>
<p>[code lang=shell]<br />
$gcc -o HelloWorld HelloWorld.c<br />
[/code]</p>
</div>

    
    
    
        <h4 class="page-header">Related</h4>
         <div class="item">

    
    
    

    
    

    <h4><a href="/post/2016-12-21-mot-chut-hieu-them-ve-hello-world-trong-c/">Một chút hiểu thêm về &#34;Hello World&#34; trong C.</a></h4>
    <h5>December 21, 2016</h5>
    
<a href="tags/compiler"><kbd class="item-tag">Compiler</kbd></a>

<a href="tags/helloworld"><kbd class="item-tag">HelloWorld</kbd></a>

<a href="tags/linker"><kbd class="item-tag">Linker</kbd></a>

<a href="tags/loader"><kbd class="item-tag">Loader</kbd></a>



</div>
  <div class="item">

    
    
    

    
    

    <h4><a href="/post/2016-12-01-loi-ve-case-sensive-khi-bien-dich-c-gcc/">Lỗi về Case-sensive khi biên dịch C (gcc)</a></h4>
    <h5>December 1, 2016</h5>
    
<a href="tags/c"><kbd class="item-tag">C</kbd></a>

<a href="tags/error"><kbd class="item-tag">Error</kbd></a>

<a href="tags/filesystem"><kbd class="item-tag">FileSystem</kbd></a>

<a href="tags/gcc"><kbd class="item-tag">GCC</kbd></a>

<a href="tags/linux"><kbd class="item-tag">Linux</kbd></a>



</div>
  <div class="item">

    
    
    

    
    

    <h4><a href="/post/2015-04-25-oebitbake-tu-hello-world-den-mot-distro/">[OE]Bitbake - Từ Hello World đến một Distro</a></h4>
    <h5>April 25, 2015</h5>
    
<a href="tags/bitbake"><kbd class="item-tag">Bitbake</kbd></a>

<a href="tags/distro"><kbd class="item-tag">Distro</kbd></a>

<a href="tags/helloworld"><kbd class="item-tag">HelloWorld</kbd></a>



</div>
 
    

    
    
        <h4 class="page-header">Comments</h4>
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "username" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    

</main>

        <footer>
            <p class="copyright text-muted">&copy; All rights reserved. Powered by <a href="https://gohugo.io">Hugo</a> and <a href="https://github.com/calintat/minimal">Minimal</a>.</p>
        </footer>

        

        
    </body>

</html>

