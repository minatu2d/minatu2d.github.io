<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>4 Stage khi biên dịch HelloWorld.c - Lazytrick</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	
	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/css/style.css">
	
	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="/" title="Lazytrick" rel="home">
				<div class="logo__title">Lazytrick</div>
				
			</a>
		</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">Home</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/post/">Posts</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/tags/">Tags</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/categories/">Category</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about/">About</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">4 Stage khi biên dịch HelloWorld.c</h1>
			
		</header><div class="content post__content clearfix">
			</p>
<h2>1. 4 Stage khi compiling</h2>
<p>Để chuyển từ 1 file source code <strong>HelloWorld.c</strong> ở trên sang dạng chạy được <strong>HelloWorld</strong> bằng GCC sẽ có 4 stages sau.<br />
Kết quả của Stage trước là sẽ là đầu vào của Stage sau.</p>
<p><img class="alignnone size-full wp-image-1745" src="{{ site.baseurl }}/assets/compiling_4_stage.png" alt="compiling_4_stage" width="756" height="490" /></p>
<p>Khi chúng ta gõ</p>
<p>[code lang=shell]<br />
$gcc -o HelloWorld HelloWorld.c<br />
[/code]</p>
<p>Thì chỉ kết quả của Stage sẽ được giữ lại, kết quả của các Stage trung gian không được lưu lại.</p>
<h2>2. Chi tiết mỗi Stage</h2>
<h3>2.1 Stage 1 : Preprocessing (Tiền xử lý)</h3>
<p>Ở Stage này, các tiền xử lý (bắt đầu băng dấu #) được xử lý. Ví dụ các chỉ thị dịch #ifdef, #if, #include sẽ được thay thế hết.<br />
Do vậy, các lỗi về sai đường dẫn file header sẽ được phát hiện. Kết quả các đoạn chị thị dịch #ifdef, #elif cũng sẽ được đưa ra.</p>
<p>Để hiển thị kết quả đầu ra của Stage này, ta có thể sử dụng command sau:</p>
<p>Khi sử dụng <strong>gcc</strong>:</p>
<p>[code lang=shell]<br />
$gcc -E HelloWorld.c &gt; HelloWorld.i<br />
[/code]</p>
<p>Hoặc sử dụng <strong>cpp</strong> (C Preprocessor)</p>
<p>[code lang=shell]<br />
$cpp HelloWorld.c &gt; HelloWorld.i<br />
[/code]</p>
<h3>2.2 Stage 2 : Biên dịch sang mã Assembly</h3>
<p>Ở Stage này, kết quả từ Stage 1 sẽ được biên dịch thành source code trong ngôn ngữ Assembly.<br />
Để hiển thị đầu ra của Stage này, ta sử dụng command sau:</p>
<p>[code lang=shell]<br />
$gcc -S HelloWorld.c<br />
[/code]</p>
<p>Ta sẽ được file <strong>HelloWorld.s</strong> trong thư mục hiện tại.</p>
<h3>2.3 Stage 3 : Biên dịch sang mã máy</h3>
<p>Ở Stage này, GCC sẽ biên dịch kết của từ Stage 2 (Assembly Code) sang dạng mã máy.<br />
Tức là GCC sẽ phải biết môi trường mà nó sẽ compile cho là gì. (Môi trường chạy hay Host)</p>
<p>Để lấy kết quả đầu ra của Stage này, ta sử dụng command sau:</p>
<p>[code lang=shell]<br />
$gcc -c HelloWorld.c<br />
[/code]</p>
<p>Ta sẽ được file <strong>HelloWorld.o</strong> nằm ở thư mục hiện tại.</p>
<h3>2.4 Stage 4 : Link để tạo file chạy được</h3>
<p>Ta đã có kết quả từ Stage là các file <strong>.o</strong>.<br />
Từ mỗi file <strong>.c</strong> sẽ tạo ra 1 file <strong>.o</strong>.</p>
<p>Đó chỉ là các file rời rạc, hay các file object hay module.</p>
<p>Để có 1 chương trình chạy được, ta cần liên kết hay là <strong>Link</strong> các file object lại.</p>
<p>Quá trình link về cơ bản, sẽ lấy nội dung (là hàm hoặc biến) rồi xếp lại theo một thứ tự để máy tính có thể hiểu và chạy được.</p>
<p>Có 2 loại link : Link tĩnh (các file <strong>.o</strong> và <strong>.a</strong>), và Link động (các file <strong>.so</strong>).</p>
<p>Đàu ra Link tĩnh là một file chứa toàn bộ mã máy kể cả các hàm thư viện chuẩn, chỉ cần load lên bộ nhớ là có thể chạy được. Vì thế kích thước thường rất lớn.</p>
<p>Ta có thể sử dụng command sau:</p>
<p>[code lang=shell]<br />
$gcc -static -o HelloWorld HelloWorld.c<br />
[/code]</p>
<p>Đầu ra của Link động là một file không chứa toàn bộ mã của các thư viện phụ thuộc. Nó có thể yêu cầu kernel load khi thực sự được chạy hoặc được gọi. Vì thế, kích thước file thường nhỏ.</p>
<p>GCC sẽ mặc định sử dụng Link động nên ta có thể sử dụng command sau:</p>
<p>[code lang=shell]<br />
$gcc -o HelloWorld HelloWorld.c<br />
[/code]</p>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item"><a class="tags__link btn" href="/tags/gcc/" rel="tag">GCC</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/helloworld/" rel="tag">HelloWorld</a></li>
	</ul>
</div>
		</footer>
	</article>
</main>



<section class="comments">
	<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "minatu2d" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2019 Lazytrick.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>