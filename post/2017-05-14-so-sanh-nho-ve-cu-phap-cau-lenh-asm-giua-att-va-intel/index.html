<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>So sánh nhỏ về cú pháp câu lệnh ASM giữa AT&amp;T và Intel - Lazytrick - Limited size memory of mind</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	
	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="https://blog.lazytrick.com/css/style.css">
	
	<link rel="shortcut icon" href="https://blog.lazytrick.com/favicon.ico">
		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-53476519-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="https://blog.lazytrick.com/" title="Lazytrick - Limited size memory of mind" rel="home">
				<div class="logo__title">Lazytrick - Limited size memory of mind</div>
				
			</a>
		</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="https://blog.lazytrick.com/">Home</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="https://blog.lazytrick.com/post/">Viết những gì?</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="https://blog.lazytrick.com/tags/">Tags</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="https://blog.lazytrick.com/categories/">Category</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="https://blog.lazytrick.com/about/">Ai viết?</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">So sánh nhỏ về cú pháp câu lệnh ASM giữa AT&amp;T và Intel</h1>
			
			


<br>
<i data-feather="calendar">
  <u>Published: <b><time datetime="2017-05-14 00:00:00 &#43;0700">Sun, 14 May 2017 08:43:10</time></b> | Last modified:<b><time datetime="2017-05-14 00:00:00 &#43;0700">Sun, 14 May 2017 08:43:10</time></b></u>
  </i> 
		</header><div class="content post__content clearfix">
			

<p><strong>Link gốc</strong>:<br />
<a href="http://www.imada.sdu.dk/Courses/DM18/Litteratur/IntelnATT.htm">http://www.imada.sdu.dk/Courses/DM18/Litteratur/IntelnATT.htm</a></p>

<p><strong>Người dịch</strong>:<br />
Ngôn ngữ Assembly không phải là ngôn ngữ tốt để viết ứng dụng,nhất là bây giờ đã là năm 2017. Có quá nhiều thứ hiệu quả và nhanh hơn. Tuy nhiên, khi cần tìm hiểu ở mức hệ điều hành, rồi driver thiết bị, thì việc đọc được Assembly là rất hữu ích.</p>

<p><strong>Nội dung</strong></p>

<p>Cú pháp ASM giữa Intel và AT&amp;T có rất nhiều điềm khác nhau rõ rệt. Điều này nhiều khi dẫn đến sự nhầm lẫn khi một người đã học một ASM của Intel trước rồi sang học ASM của AT&amp;T hoặc ngoặc lại. Bài này, chúng ta sẽ xem xét những cái khác biệt cơ bản đó.</p>

<h2 id="1-về-tiền-tố-prefixes">1. Về tiền tố (Prefixes)</h2>

<p>Cú pháp Intel thì không bất cứ tiền tố nào.<br />
Còn cú pháp AT&amp;T:<br />
- thanh ghi được theo sau tiền tố <strong>%</strong><br />
- giá trị được theo sau tiền tố <strong>$</strong></p>

<p>Cú pháp Intel sử dụng hậu tố &lsquo;h&rsquo; sau giá trị cơ số 16, &lsquo;b&rsquo; sau giá trị cơ số 2.<br />
Nếu giá trị đầu tiên của giá trị cơ số 16 là chữ thì nó phải được theo sao bằng tiền tố 0.</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#228b22">// Intex Syntax  
</span><span style="color:#228b22"></span>mov eax,<span style="color:#b452cd">1</span>  
mov ebx,<span style="color:#b452cd">0ff</span>h  
<span style="color:#00688b;font-weight:bold">int</span> <span style="color:#b452cd">80</span>h

<span style="color:#228b22">// AT&amp;T Syntax  
</span><span style="color:#228b22"></span>movl <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#b452cd">1</span>,%eax  
movl <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#b452cd">0xff</span>,%ebx  
<span style="color:#00688b;font-weight:bold">int</span> <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#b452cd">0x80</span>  </code></pre></div>
<h2 id="2-về-chiều-của-toán-tử-direction-of-operands">2. Về chiều của toán tử (Direction of Operands)</h2>

<p>Chiều của toán tử theo cú pháp Intel ngược với cú pháp AT&amp;T.<br />
Trong cú pháp Intel, toán tử đầu tiên (hay tham số đầu tiên) là đích. Toán tử thứ 2 là nguồn.<br />
Trong cú pháp AT&amp;T thì ngược lại. Đầu tiên là nguồn, thứ 2 là đích.</p>

<p><strong>Tham khảo thêm</strong>:<br />
Có một chú ý về <a href="https://lazytrick.wordpress.com/2017/05/14/lenh-mov-trong-assembly/">lệnh MOV</a> về giá trị đích, nguồn do người dịch tổng hợp</p>

<p>Ví dụ:</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#228b22">//Intex Syntax  
</span><span style="color:#228b22"></span>instr dest,source  
mov eax,[ecx]

<span style="color:#228b22">//AT&amp;T Syntax  
</span><span style="color:#228b22"></span>instr source,dest  
movl (%ecx),%eax  </code></pre></div>
<h2 id="3-cách-chỉ-định-bộ-nhớ-memory-operands">3. Cách chỉ định bộ nhớ (Memory Operands)</h2>

<p>Cách chỉ định địa chỉ cũng khác nhau.<br />
Trong cú pháp Intel, thanh ghi chứa địa chỉ được bao bởi 2 dấu ngoặc vuông <code>[]</code>.<br />
Trong cú pháp AT&amp;T, được bao bởi 3 dấu ngoặc đơn <code>()</code>.</p>

<p>Ví dụ:</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#228b22">//Intex Syntax  
</span><span style="color:#228b22"></span>mov eax,[ebx]  
mov eax,[ebx+<span style="color:#b452cd">3</span>]

<span style="color:#228b22">//AT&amp;T Syntax  
</span><span style="color:#228b22"></span>movl (%ebx),%eax  
movl <span style="color:#b452cd">3</span>(%ebx),%e  </code></pre></div>
<p>Kiểu của AT&amp;T có vẻ phức tạo hơn kiểu của Intel.<br />
Kiểu Intel, cách viết sẽ có dạng sau: <code>segreg[base+index * scale + disp]</code><br />
Kiểu AT&amp;T, sẽ là: <code>%segreg:disp(base,index,scale)</code></p>

<p>Các giá trị <code>index/scale/disp/segreg</code> có thể bị lược bỏ.<br />
<code>Scale</code> nếu không được chỉ định thì <code>index</code> phai được chỉ định.<br />
Giá trị mặc định của <code>Scale</code> là .</p>

<p>Ví dụ:</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#228b22">//Intel Syntax  
</span><span style="color:#228b22"></span>instr foo,segreg:[base+index*scale+disp]  
mov eax,[ebx+<span style="color:#b452cd">20</span>h]  
add eax,[ebx+ecx*<span style="color:#b452cd">2</span>h  
lea eax,[ebx+ecx]  
sub eax,[ebx+ecx*<span style="color:#b452cd">4</span>h-<span style="color:#b452cd">20</span>h]

<span style="color:#228b22">//AT&amp;T Syntax  
</span><span style="color:#228b22"></span>instr %segreg:disp(base,index,scale),foo  
movl <span style="color:#b452cd">0x20</span>(%ebx),%eax  
addl (%ebx,%ecx,<span style="color:#b452cd">0x2</span>),%eax  
leal (%ebx,%ecx),%eax  
subl -<span style="color:#b452cd">0x20</span>(%ebx,%ecx,<span style="color:#b452cd">0x4</span>),%eax  </code></pre></div>
<p>Như bạn cũng thấy, kiểu AT&amp;T khá khó hiểu.<br />
Cách viết <code>[base + index*scale + disp] trong dễ hiểu hơn nhiều cách viết</code>disp(base, index, scale)`</p>

<h2 id="4-về-hậu-tố">4. Về hậu tố</h2>

<p>Cái này khác nhau nhiều đây.<br />
Cú pháp AT&amp;T sử dụng hậu tố gợi nhớ cho câu lệnh để ám chỉ kích thước toán tử (DEST, SRC).<br />
<code>l</code> nghĩa là <code>long</code><br />
<code>w</code> nghĩa là <code>word</code><br />
<code>b</code> nghĩa là <code>byte</code><br />
Cú pháp Intel thì lại sử dụng hậu tố gợi nhớ cho bộ nhớ, phía địa chỉ.<br />
ví dụ:</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">byte ptr  
word ptr  
dword ptr  
// word tương <span style="color:#a61717;background-color:#e3d2d2">ứ</span>ng với <span style="color:#cd5555">&#34;long&#34;</span>  </code></pre></div>
<p>Nó tương tự giống định nghĩa kiểu dữ liệu trongC.</p>

<p>Ví dụ so sanh:</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#228b22">//Intel Syntax  
</span><span style="color:#228b22"></span>mov al,bl  
mov ax,bx  
mov eax,ebx  
mov eax, dword ptr [ebx]

<span style="color:#228b22">//AT&amp;T Syntax  
</span><span style="color:#228b22"></span>movb %bl,%al  
movw %bx,%ax  
movl %ebx,%eax  
movl (%ebx),%eax  </code></pre></div>
		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item"><a class="tags__link btn" href="https://blog.lazytrick.com/tags/assembly/" rel="tag">Assembly</a></li>
	</ul>
</div>
		</footer>
	</article>
</main>



<section class="comments">
	<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-blog-lazytrick-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2020 Lazytrick - Limited size memory of mind.
			<span class="footer__copyright-credits">Convert nội dung Markdown sang HTML bằng <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and sử dụng theme <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a>.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="https://blog.lazytrick.com/js/menu.js"></script>
</body>
</html>